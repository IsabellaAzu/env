# 2.各種OS設定

初期設定の変更はcloud-config.ymlで上書きする  →　/var/lib/coreos-install/user_dataにコピペ  
※[dockerコマンド](http://qiita.com/curseoff/items/a9e64ad01d673abb6866)  


```
$ sudo coreos-cloudinit -from-file=./cloud-config.yml
$ sudo cp cloud-config.yml /var/lib/coreos-install/user_data
$ sudo reboot
```

<a href="#anc1">(1)SSHポートの変更</a>  
<a href="#anc2">(2)ファイヤーウォール</a>  
<a href="#anc3">(3)nginx</a>  
<a href="#anc4">(4)独自ドメインの準備</a>  
　  
- - - 
　  
<a id="anc1" name="anc1"></a>
## (1)SSHポートの変更

```
# 状態確認
$ systemctl status sshd.socket
```

cloud-config.ymlにポート番号(xxxのところ)を指定する
```
# cloud-config
coreos:
  units:
  - name: sshd.socket
    command: start
    content: |
      [Socket]
      ListenStream=xxx
      Accept=yes
```
```
# cloud-config.ymlの設定を反映
$ sudo coreos-cloudinit -from-file=./cloud-config.yml
```







## (1)独自ドメインの準備
さくらのVPSにお名前.comのドメインを付与  
http://akiyoko.hatenablog.jp/entry/2012/09/30/081001  
【さくらVPS】お名前.comで取得したドメインをさくらのVPSで使用する  
http://qiita.com/daikiichikawa/items/4a906bbf7ad6bf4df163  
　  
- - - 
　  
<a id="anc2" name="anc2"></a>
## (2)nginx（全然分からんｗ）

コンテナの中にcentOSとか入れてyum installとかするもんなのか？  
http://webkaru.net/linux/centos-6-3-nginx-install/  
　↓  
http://9ensan.com/blog/server/sakura-vps-nginx-reverse-proxy/  
http://qiita.com/yakumomo/items/4ee2d0f13f24b8f024b6  
http://www.crystalsnowman.com/?p=749  
http://qiita.com/murachi1208/items/d04797b0b61e69018938  
https://sys-guard.com/yuu_linux/19-01.php  
http://labs.septeni.co.jp/entry/2015/11/19/213714  
http://qiita.com/hakaicode/items/38cbed889a03a33cdfcf  
http://qiita.com/NewGyu/items/d0b0d6074e13acd51f3e  
http://qiita.com/ABE_TAKASHI/items/654ef6ed22071c93d6f2 （最終目標）  


### dockerのリポジトリからイメージをpull(20170206のlatestで約180MBくらい)
```
# sudoしないと、「Cannot connect to the Docker daemon. Is the docker daemon running on this host?」
$ sudo docker pull nginx
# imageの確認
$ sudo docker images

# コンテナ作成
$ sudo docker run --privileged -td -p 80:80 -v aaa:/Docker --name=aaa nginx /sbin/init
# --privileged : 
# -td : 
# -p 80:80 : 80から来たのをコンテナの80ポートに転送
# -v aaa:/Docker : -volumeのエイリアスで、aaaフォルダと/Dockerを共有
# --name=aaa : aaaのコンテナ名で起動
# nginx : dockerにあるイメージ名
# /sbin/init : ルート権限みたいなもの？
```
imageの格納先は、「/var/lib/docker/」（[詳細](http://deeeet.com/writing/2013/12/16/where-are-docker-images-storede/)）  


### nginxの入ったコンテナに
https://docs.docker.com/engine/reference/commandline/exec/
```
# 入る
$ docker exec -it aaa /bin/bash
# -i : --interactiveのエイリアス
# -t : --ttyのエイリアス

# 出る
$ exit
```

　  
- - - 
　  
<a id="anc3" name="anc3"></a>
## (3)xxx



　  
- - - 
　  
## index
<a href="./readme.md">readme.md</a>  
<a href="./1.OSインストール.md">1.OSインストール</a>  
2.各種設定  
<a href="./3.一般ユーザー追加.md">3.一般ユーザー追加</a>  
<a href="./4.SSH接続の設定変更.md">4.SSH接続の設定変更</a>  
<a href="./5.ファイアウォールの設定.md">5.ファイアウォールの設定</a>  
　  
