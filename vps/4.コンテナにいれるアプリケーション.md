# 4.コンテナにいれるアプリケーション
　  
   
- - - 


## (1)コンテナ
CoreOS で起動中のコンテナの中に入る  
http://qiita.com/spesnova/items/8121615d4634500a331c  
Dockerコマンドメモ  
http://qiita.com/curseoff/items/a9e64ad01d673abb6866  
Dockerのすべてが5分でわかるまとめ!(コマンド一覧付き)  
http://paiza.hatenablog.com/entry/docker_intro  
よく使うDockerコマンド  
http://qiita.com/noralife/items/18301143c20cc5172c56  




#### (1-1)コンテナの管理

##### (1-1-1)コンテナベースイメージの容量比較  

| [Alpine](https://alpinelinux.org/)| CentOS| Ubuntu|  Debian|
|:------|------:|------:|:------:|
|  4.0MB|196.8MB|122.0MB|125.1 MB|

Alpine Linux使ってみた  
http://qiita.com/tukiyo3/items/247f853c81bf00e82c11  
Alpine Linux で軽量な Docker イメージを作る
http://qiita.com/pottava/items/970d7b5cda565b995fe7#fn2


```command
# コンテナのイメージ取得
$ sudo docker pull alpine
# ホストのコンテナイメージ一覧
$ sudo docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
alpine              latest              xxxxxxxxxxxx        6 weeks ago         3.984 MB
```

##### (1-1-2)docker hub private repository
コンテナイメージの保存先。アカウントとリポジトリを作っておく。１個まで無料。  
https://hub.docker.com/


##### (1-1-3)Container orchestration

###### docker-compose

CoreOSにdocker-composeを導入  
http://qiita.com/hiroseabook/items/50bda4b0fd85ab228c6d  
http://cortyuming.hateblo.jp/entry/2015/04/26/164606  
```command
# rootに変身して、rootのホームディレクトリに勝手に移動
$ sudo su -
# インストール先のディレクトリ作成
$ mkdir -p /opt/bin # /usr/local/bin/だとcoreOSでは
# インストール
$ sudo curl -L https://github.com/docker/compose/releases/download/1.13.0/docker-compose-`uname -s`-`uname -m` > /opt/bin/docker-compose

# インストールできたか確認
$ docker-compose -v
> -su: /opt/bin/docker-compose: Permission denied
# アクセス権と状態の表示
$ ls -l /opt/bin/docker-compose
> -rw-r--r--. 1 root root 8273264 May 10 15:20 /opt/bin/docker-compose
# アクセス権の変更
$ chmod +x /opt/bin/docker-compose
> -rwxr-xr-x. 1 root root 8273264 May 10 15:20 /opt/bin/docker-compose
# インストールできたか再確認
$ docker-compose -v
> docker-compose version 1.13.0, build 1719ceb
```
※[sudo su とハイフン有り無しの違いについて](http://javatechnology.net/service/sudo-su-hyphen/)  

設定ファイルdocker-compose.ymlの用意  
http://qiita.com/ABE_TAKASHI/items/654ef6ed22071c93d6f2  
https://webnaut.jp/technology/20170126-1990/  
```yml
# 任意のディレクトリにdocker-compose.yml

【編集中】

version: '2'
services:
  proxy:
    image: jwilder/nginx-proxy
    privileged: true
    ports:
      - 80:80
    volumes:
      - /etc/nginx/vhost.d
      - /usr/share/nginx/html
      - /var/run/docker.sock:/tmp/docker.sock:ro
    container_name: XXX
mysite_db:
    image: mysql
    environment:
      MYSQL_ROOT_PASSWORD: password
  mysite:
    image: wordpress
    environment:
      WORDPRESS_DB_PASSWORD: password
      WORDPRESS_DB_USER: root
      WORDPRESS_DB_HOST: mysite_db:3306
      WORDPRESS_DB_NAME: mysite
      VIRTUAL_HOST: IPアドレス、ドメイン名など
      VIRTUAL_PORT: 80
    links:
      - mysite_db

```
※[docker-compose.ymlのkey−value](http://docs.docker.jp/compose/compose-file.html#image)
http://unskilled.site/%E4%BD%BF%E3%81%84%E6%96%B9%E5%9F%BA%E6%9C%AC%E7%89%88dockercompose%E3%81%A7%E3%82%B3%E3%83%B3%E3%83%86%E3%83%8A%E7%AB%8B%E3%81%A1%E4%B8%8A%E3%81%92%E3%83%BB%E9%80%A3%E6%90%BA%E3%82%92%E6%A5%BD/  
http://qiita.com/KappaBull/items/15de7a2bf52a5d38b11e  

```command
# dockerのimageを元にコンテンを新規作成し起動
$ sudo docker-compose up -d
```



###### Container orchestration参考情報
composeとswarm  
https://www.slideshare.net/zembutsu/introduction-to-docker-compose-and-swarm  
CoreOSにdocker-composeを導入  
http://qiita.com/hiroseabook/items/50bda4b0fd85ab228c6d  
docker-composeを使うと複数コンテナの管理が便利に  
http://qiita.com/y_hokkey/items/d51e69c6ff4015e85fce  
docker-compose、docker-swarm、kubernetes  
https://bitgandtter.blog/2015/11/19/docker-compose-docker-swarm-or-kubernetes/  
https://www.infoq.com/jp/news/2016/07/dockercon-docker-swarm  
https://hackerslog.net/post/labs/docker-letsencrypt-on-docker-and-nginx/  
Docker SwarmとKubernetesの比較  
https://www.creationline.com/lab/13762  



## Ruby on Rails



dockerでRailsの開発環境を手軽に準備  
https://unicorn.limited/jp/item/325  
> ホストOSのあるディレクトリにRailsプロジェクトのファイル一式を置く  


dockerfileで  
http://morizyun.github.io/docker/about-dockerfile-description.html  
http://morizyun.github.io/docker/docker-compose-rails.html  


railsをdockerで動かしたい場合の構成はどうするべきか  
http://qiita.com/k-shogo/items/592e243f9763d0c3b10a  
Docker ComposeでRuby+PostgreSQLによるRails開発環境を構築する方法  
http://post.simplie.jp/posts/114  
  
http://qiita.com/pokohide/items/7397b92a188da841b435  
http://qiita.com/ledsun/items/d63f2837861e69927b73  


　  
複雑な構成のrailsアプリをdockerで動かしたい場合はどうするべきか  
http://qiita.com/k-shogo/items/3c887cbf86b3cab85b72  
Ruby on Rails アプリケーションを Dockerで動かす  
http://qiita.com/ledsun/items/d63f2837861e69927b73  
dockerでRails5+postgres+redisの開発環境を丁寧に構築してみた  
http://qiita.com/pokohide/items/7397b92a188da841b435  
Docker で Rails5 の開発環境を「rails new」から構築する  
http://qiita.com/kawasin73/items/d5836007c715b7f7885f  

- - - 

## 本番運用を見据えたDocker Registry選定
http://qiita.com/Vexus2/items/e84f5869c01e08438538  
- Docker Hub
- Quay.io
- CoreOS Enterprise Registry
- Docker Registry





- - - 
　  
## index
<a href="./readme.md">readme.md</a>  
<a href="./1.OSインストール.md">1.OSインストール</a>  
<a href="./2.OS設定.md">2.OS設定</a>  
<a href="./3.Units設定.md">3.Units設定</a>  
4.コンテナにいれるアプリケーション  
　  
